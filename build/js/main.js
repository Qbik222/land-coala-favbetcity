"use strict";

var playBtn = document.querySelector('.bonus__main-wheel-btn'),
  main = document.querySelector('.bonus__main'),
  wheel = document.querySelector('.bonus__main-wheel-reel'),
  overlay = document.querySelector('.bonus__overlay'),
  popupFirst = document.querySelector('.bonus__firstWin'),
  overflow = document.querySelector('body'),
  wrapper = document.querySelector('.bonus'),
  bonusStart = document.querySelector('.bonus__start'),
  bonusText = document.querySelector('.bonus__text'),
  audioCoin = document.querySelector('.audio-coins'),
  audioFirework = document.querySelector('.audio-firework'),
  audioMain = document.querySelector('.audio-main'),
  audioWheel = document.querySelector('.audio-wheel'),
  btnVolume = document.querySelector('.bonus__music'),
  btnVolumeImg = document.querySelector('.bonus__music-img'),
  body = document.querySelector('body'),
  allLink = document.querySelector('.all-link'),
  popupText = document.querySelector('.bonus__firstWin-text');
audioMain.volume = 0.35;
audioFirework.volume = 0.6;
audioCoin.volume = 0.6;

// audioMain.volume = 0
// audioFirework.volume = 0
// audioCoin.volume = 0

function scrollToTop() {
  var currentPosition = document.documentElement.scrollTop || document.body.scrollTop;
  if (currentPosition > 0) {
    window.requestAnimationFrame(scrollToTop);
    window.scrollTo(0, currentPosition - currentPosition / 8);
  }
}
btnVolume.addEventListener('click', function () {
  if (btnVolume.classList.contains('off')) {
    btnVolume.classList.remove('off');
    btnVolume.classList.add('on');
    audioMain.play();
    audioFirework.play();
    btnVolumeImg.setAttribute('src', 'img/sound-on.svg');
  } else {
    btnVolume.classList.remove('on');
    btnVolume.classList.add('off');
    audioMain.pause();
    audioMain.currentTime = 0;
    audioFirework.pause();
    audioFirework.currentTime = 0;
    audioWheel.pause();
    audioWheel.currentTime = 0;
    audioCoin.pause();
    audioCoin.currentTime = 0;
    btnVolumeImg.setAttribute('src', 'img/sound-off.svg');
  }
});
setTimeout(function () {
  bonusStart.classList.add('_active');
  main.classList.add('_active');
  setTimeout(function () {
    bonusText.classList.add('_visible');
  }, 1200);
}, 3500);
playBtn.addEventListener('click', function () {
  runFirstRotation();
});
function runFirstRotation() {
  scrollToTop();
  btnVolume.classList.remove('off');
  btnVolume.classList.add('on');
  btnVolumeImg.setAttribute('src', 'img/sound-on.svg');
  audioMain.play();
  audioFirework.play();
  audioWheel.play();
  wheel.classList.add('reel-rotation-first');
  playBtn.classList.remove('pulse-btn');
  playBtn.style.cursor = 'default';
  wrapper.style.pointerEvents = 'none';
  wrapper.style.overflow = 'hidden';
  body.style.overflow = 'hidden';
  setTimeout(function () {
    doAfterFirstRotation();
  }, 6000);
}
function doAfterFirstRotation() {
  popupText.classList.add('_visible');
  allLink.style.display = 'block';
  audioCoin.play();
  wheel.style.transform = 'rotate(1440deg)';
  wheel.classList.remove('reel-rotation-first');
  displayPopup(popupFirst);
  wrapper.style.pointerEvents = 'auto';
  overflow.style.overflow = 'hidden';
}
function displayPopup(popup) {
  overlay.classList.remove('opacity-overlay');
  popup.classList.remove('hide');
}
window.addEventListener('orientationchange', function () {
  window.location.reload();
});
(function () {
  var url = new URL(window.location.href);
  var params = ['l', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content', 'param1', 'param2', 'param3', 'param4', 'creative_type', 'creative_id'];
  var linkParams = ['affid', 'cpaid']; // ищем в url redirectUrl в url:

  if (url.searchParams.has('redirectUrl')) {
    var redirectUrl = new URL(url.searchParams.get('redirectUrl'));
    if (redirectUrl.href.match(/\//g).length === 4 && redirectUrl.searchParams.get('l')) {
      //если ссылка в ссылка redirectUrl корректная
      localStorage.setItem('redirectUrl', redirectUrl.href); // указываем точкой входа домен с протоколом из redirectUrl
    }
  }
  params.forEach(function (param) {
    if (url.searchParams.has(param)) localStorage.setItem(param, url.searchParams.get(param));
  });
  linkParams.forEach(function (linkParam) {
    if (url.searchParams.has(linkParam)) localStorage.setItem(linkParam, url.searchParams.get(linkParam));
  });
  window.addEventListener('click', function (e) {
    var link,
      parent = e.target.closest('a');
    if (parent.getAttribute('href') !== 'https://tds.favbet.partners') {
      return;
    }
    if (parent) {
      e.preventDefault();
      var affid = localStorage.getItem('affid');
      var cpaid = localStorage.getItem('cpaid');
      if (localStorage.getItem("redirectUrl")) {
        link = new URL(localStorage.getItem("redirectUrl"));
      } else {
        link = new URL(parent.href);
        if (affid && cpaid) {
          link.pathname = '/' + affid + '/' + cpaid;
        }
      }
      params.forEach(function (param) {
        if (url.searchParams.has(param)) {
          link.searchParams.set(param, localStorage.getItem(param));
        }
      });
      document.location.href = link;
    }
  });
})();
var popupFirstBtn = document.querySelector(".show-popup");
var popupFirstBtnClose = document.querySelector(".close-popup");
popupFirstBtn.addEventListener("click", function () {
  displayPopup(popupFirst);
  popupText.classList.add('_visible');
});
popupFirstBtnClose.addEventListener("click", function () {
  overlay.classList.add('opacity-overlay');
  popupFirst.classList.add('hide');
  popupText.classList.remove('_visible');
});
"use strict";
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsicGxheUJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1haW4iLCJ3aGVlbCIsIm92ZXJsYXkiLCJwb3B1cEZpcnN0Iiwib3ZlcmZsb3ciLCJ3cmFwcGVyIiwiYm9udXNTdGFydCIsImJvbnVzVGV4dCIsImF1ZGlvQ29pbiIsImF1ZGlvRmlyZXdvcmsiLCJhdWRpb01haW4iLCJhdWRpb1doZWVsIiwiYnRuVm9sdW1lIiwiYnRuVm9sdW1lSW1nIiwiYm9keSIsImFsbExpbmsiLCJwb3B1cFRleHQiLCJ2b2x1bWUiLCJzY3JvbGxUb1RvcCIsImN1cnJlbnRQb3NpdGlvbiIsImRvY3VtZW50RWxlbWVudCIsInNjcm9sbFRvcCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNjcm9sbFRvIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiYWRkIiwicGxheSIsInNldEF0dHJpYnV0ZSIsInBhdXNlIiwiY3VycmVudFRpbWUiLCJzZXRUaW1lb3V0IiwicnVuRmlyc3RSb3RhdGlvbiIsInN0eWxlIiwiY3Vyc29yIiwicG9pbnRlckV2ZW50cyIsImRvQWZ0ZXJGaXJzdFJvdGF0aW9uIiwiZGlzcGxheSIsInRyYW5zZm9ybSIsImRpc3BsYXlQb3B1cCIsInBvcHVwIiwibG9jYXRpb24iLCJyZWxvYWQiLCJ1cmwiLCJVUkwiLCJocmVmIiwicGFyYW1zIiwibGlua1BhcmFtcyIsInNlYXJjaFBhcmFtcyIsImhhcyIsInJlZGlyZWN0VXJsIiwiZ2V0IiwibWF0Y2giLCJsZW5ndGgiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiZm9yRWFjaCIsInBhcmFtIiwibGlua1BhcmFtIiwiZSIsImxpbmsiLCJwYXJlbnQiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiZ2V0QXR0cmlidXRlIiwicHJldmVudERlZmF1bHQiLCJhZmZpZCIsImdldEl0ZW0iLCJj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ZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX21haW4td2hlZWwtYnRuJyksXG4gICAgICBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19tYWluJyksXG4gICAgICB3aGVlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fbWFpbi13aGVlbC1yZWVsJyksXG4gICAgICBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19vdmVybGF5JyksXG4gICAgICBwb3B1cEZpcnN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19maXJzdFdpbicpLFxuICAgICAgb3ZlcmZsb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JyksXG4gICAgICB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzJyksXG4gICAgICBib251c1N0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX19zdGFydCcpLFxuICAgICAgYm9udXNUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvbnVzX190ZXh0JyksXG4gICAgICBhdWRpb0NvaW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXVkaW8tY29pbnMnKSxcbiAgICAgIGF1ZGlvRmlyZXdvcmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXVkaW8tZmlyZXdvcmsnKSxcbiAgICAgIGF1ZGlvTWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdWRpby1tYWluJyksXG4gICAgICBhdWRpb1doZWVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1ZGlvLXdoZWVsJyksXG4gICAgICBidG5Wb2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX211c2ljJyksXG4gICAgICBidG5Wb2x1bWVJbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9udXNfX211c2ljLWltZycpLFxuICAgICAgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSxcbiAgICAgIGFsbExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWxsLWxpbmsnKSxcbiAgICAgIHBvcHVwVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib251c19fZmlyc3RXaW4tdGV4dCcpXG5cbmF1ZGlvTWFpbi52b2x1bWUgPSAwLjM1XG5hdWRpb0ZpcmV3b3JrLnZvbHVtZSA9IDAuNlxuYXVkaW9Db2luLnZvbHVtZSA9IDAuNlxuXG4vLyBhdWRpb01haW4udm9sdW1lID0gMFxuLy8gYXVkaW9GaXJld29yay52b2x1bWUgPSAwXG4vLyBhdWRpb0NvaW4udm9sdW1lID0gMFxuXG5mdW5jdGlvbiBzY3JvbGxUb1RvcCgpIHtcbiAgICBjb25zdCBjdXJyZW50UG9zaXRpb24gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO1xuICAgIGlmIChjdXJyZW50UG9zaXRpb24gPiAwKSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoc2Nyb2xsVG9Ub3ApO1xuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgY3VycmVudFBvc2l0aW9uIC0gY3VycmVudFBvc2l0aW9uIC8gOCk7XG4gICAgfVxufVxuXG5idG5Wb2x1bWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgaWYoYnRuVm9sdW1lLmNsYXNzTGlzdC5jb250YWlucygnb2ZmJykpe1xuICAgICAgICBidG5Wb2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgnb2ZmJylcbiAgICAgICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5hZGQoJ29uJylcbiAgICAgICAgYXVkaW9NYWluLnBsYXkoKVxuICAgICAgICBhdWRpb0ZpcmV3b3JrLnBsYXkoKVxuICAgICAgICBidG5Wb2x1bWVJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCAnaW1nL3NvdW5kLW9uLnN2ZycpXG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBidG5Wb2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgnb24nKVxuICAgICAgICBidG5Wb2x1bWUuY2xhc3NMaXN0LmFkZCgnb2ZmJylcbiAgICAgICAgYXVkaW9NYWluLnBhdXNlKClcbiAgICAgICAgYXVkaW9NYWluLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgYXVkaW9GaXJld29yay5wYXVzZSgpXG4gICAgICAgIGF1ZGlvRmlyZXdvcmsuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICBhdWRpb1doZWVsLnBhdXNlKClcbiAgICAgICAgYXVkaW9XaGVlbC5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgIGF1ZGlvQ29pbi5wYXVzZSgpXG4gICAgICAgIGF1ZGlvQ29pbi5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgIGJ0blZvbHVtZUltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsICdpbWcvc291bmQtb2ZmLnN2ZycpXG4gICAgfVxufSlcblxuc2V0VGltZW91dChmdW5jdGlvbiAoKXtcbiAgICBib251c1N0YXJ0LmNsYXNzTGlzdC5hZGQoJ19hY3RpdmUnKVxuICAgIG1haW4uY2xhc3NMaXN0LmFkZCgnX2FjdGl2ZScpXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKXtcbiAgICAgICAgYm9udXNUZXh0LmNsYXNzTGlzdC5hZGQoJ192aXNpYmxlJylcbiAgICB9LCAxMjAwKVxuXG59LCAzNTAwKTtcblxuXG5wbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHJ1bkZpcnN0Um90YXRpb24oKVxufSlcblxuZnVuY3Rpb24gcnVuRmlyc3RSb3RhdGlvbigpIHtcbiAgICBzY3JvbGxUb1RvcCgpXG4gICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ29mZicpXG4gICAgYnRuVm9sdW1lLmNsYXNzTGlzdC5hZGQoJ29uJylcbiAgICBidG5Wb2x1bWVJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCAnaW1nL3NvdW5kLW9uLnN2ZycpXG4gICAgYXVkaW9NYWluLnBsYXkoKVxuICAgIGF1ZGlvRmlyZXdvcmsucGxheSgpXG4gICAgYXVkaW9XaGVlbC5wbGF5KClcbiAgICB3aGVlbC5jbGFzc0xpc3QuYWRkKCdyZWVsLXJvdGF0aW9uLWZpcnN0JylcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3B1bHNlLWJ0bicpXG4gICAgcGxheUJ0bi5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCdcbiAgICB3cmFwcGVyLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSdcbiAgICB3cmFwcGVyLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbidcbiAgICBib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbidcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZG9BZnRlckZpcnN0Um90YXRpb24oKVxuICAgIH0sIDYwMDApXG59XG5cbmZ1bmN0aW9uIGRvQWZ0ZXJGaXJzdFJvdGF0aW9uKCkge1xuICAgIHBvcHVwVGV4dC5jbGFzc0xpc3QuYWRkKCdfdmlzaWJsZScpXG4gICAgYWxsTGluay5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xuICAgIGF1ZGlvQ29pbi5wbGF5KClcbiAgICB3aGVlbC5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDE0NDBkZWcpJ1xuICAgIHdoZWVsLmNsYXNzTGlzdC5yZW1vdmUoJ3JlZWwtcm90YXRpb24tZmlyc3QnKVxuICAgIGRpc3BsYXlQb3B1cChwb3B1cEZpcnN0KVxuICAgIHdyYXBwZXIuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJ1xuICAgIG92ZXJmbG93LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbidcbn1cblxuXG5mdW5jdGlvbiBkaXNwbGF5UG9wdXAocG9wdXApIHtcbiAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHktb3ZlcmxheScpXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsICgpID0+IHtcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbn0pO1xuXG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgdmFyIHBhcmFtcyA9IFsnbCcsICd1dG1fc291cmNlJywgJ3V0bV9tZWRpdW0nLCAndXRtX2NhbXBhaWduJywgJ3V0bV90ZXJtJywgJ3V0bV9jb250ZW50JywgJ3BhcmFtMScsICdwYXJhbTInLCAncGFyYW0zJywgJ3BhcmFtNCcsICdjcmVhdGl2ZV90eXBlJywgJ2NyZWF0aXZlX2lkJ107XG4gICAgdmFyIGxpbmtQYXJhbXMgPSBbJ2FmZmlkJywgJ2NwYWlkJ107IC8vINC40YnQtdC8INCyIHVybCByZWRpcmVjdFVybCDQsiB1cmw6XG5cbiAgICBpZiAodXJsLnNlYXJjaFBhcmFtcy5oYXMoJ3JlZGlyZWN0VXJsJykpIHtcbiAgICAgICAgdmFyIHJlZGlyZWN0VXJsID0gbmV3IFVSTCh1cmwuc2VhcmNoUGFyYW1zLmdldCgncmVkaXJlY3RVcmwnKSk7XG5cbiAgICAgICAgaWYgKHJlZGlyZWN0VXJsLmhyZWYubWF0Y2goL1xcLy9nKS5sZW5ndGggPT09IDQgJiYgcmVkaXJlY3RVcmwuc2VhcmNoUGFyYW1zLmdldCgnbCcpKSB7XG4gICAgICAgICAgICAvL9C10YHQu9C4INGB0YHRi9C70LrQsCDQsiDRgdGB0YvQu9C60LAgcmVkaXJlY3RVcmwg0LrQvtGA0YDQtdC60YLQvdCw0Y9cbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyZWRpcmVjdFVybCcsIHJlZGlyZWN0VXJsLmhyZWYpOyAvLyDRg9C60LDQt9GL0LLQsNC10Lwg0YLQvtGH0LrQvtC5INCy0YXQvtC00LAg0LTQvtC80LXQvSDRgSDQv9GA0L7RgtC+0LrQvtC70L7QvCDQuNC3IHJlZGlyZWN0VXJsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgaWYgKHVybC5zZWFyY2hQYXJhbXMuaGFzKHBhcmFtKSkgbG9jYWxTdG9yYWdlLnNldEl0ZW0ocGFyYW0sIHVybC5zZWFyY2hQYXJhbXMuZ2V0KHBhcmFtKSk7XG4gICAgfSk7XG5cbiAgICBsaW5rUGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKGxpbmtQYXJhbSkge1xuICAgICAgICBpZiAodXJsLnNlYXJjaFBhcmFtcy5oYXMobGlua1BhcmFtKSkgbG9jYWxTdG9yYWdlLnNldEl0ZW0obGlua1BhcmFtLCB1cmwuc2VhcmNoUGFyYW1zLmdldChsaW5rUGFyYW0pKTtcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBsaW5rLFxuICAgICAgICAgICAgcGFyZW50ID0gZS50YXJnZXQuY2xvc2VzdCgnYScpO1xuXG4gICAgICAgIGlmIChwYXJlbnQuZ2V0QXR0cmlidXRlKCdocmVmJykgIT09ICdodHRwczovL3Rkcy5mYXZiZXQucGFydG5lcnMnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB2YXIgYWZmaWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWZmaWQnKTtcbiAgICAgICAgICAgIHZhciBjcGFpZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjcGFpZCcpO1xuXG4gICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJyZWRpcmVjdFVybFwiKSkge1xuICAgICAgICAgICAgICAgIGxpbmsgPSBuZXcgVVJMKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicmVkaXJlY3RVcmxcIikpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsaW5rID0gbmV3IFVSTChwYXJlbnQuaHJlZik7XG4gICAgICAgICAgICAgICAgaWYgKGFmZmlkICYmIGNwYWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsucGF0aG5hbWUgPSAnLycgKyBhZmZpZCArICcvJyArIGNwYWlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHVybC5zZWFyY2hQYXJhbXMuaGFzKHBhcmFtKSkge1xuICAgICAgICAgICAgICAgICAgICBsaW5rLnNlYXJjaFBhcmFtcy5zZXQocGFyYW0sIGxvY2FsU3RvcmFnZS5nZXRJdGVtKHBhcmFtKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBsaW5rO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuXG5jb25zdCBwb3B1cEZpcnN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaG93LXBvcHVwXCIpO1xuY29uc3QgcG9wdXBGaXJzdEJ0bkNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZS1wb3B1cFwiKTtcblxucG9wdXBGaXJzdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgZGlzcGxheVBvcHVwKHBvcHVwRmlyc3QpXG4gICAgcG9wdXBUZXh0LmNsYXNzTGlzdC5hZGQoJ192aXNpYmxlJylcbn0pXG5cbnBvcHVwRmlyc3RCdG5DbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT57XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdvcGFjaXR5LW92ZXJsYXknKVxuICAgIHBvcHVwRmlyc3QuY2xhc3NMaXN0LmFkZCgnaGlkZScpXG4gICAgcG9wdXBUZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ192aXNpYmxlJylcbn0pXG5cblxuIiwiIl19
